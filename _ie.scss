@import './tools/breakpoint';

// stylelint-disable declaration-no-important, selector-max-universal

// =============================================================================
// ^IE hacks
// =============================================================================
// Making world a bit better for IE

@import './objects/clearfix';

@mixin clearfix ($ns) { @include exports($ns: $ns); }

// -----------------------------------------------------------------------------
// Flex aligment hacks
// -----------------------------------------------------------------------------
// When used with `.o-grid`, try to mimic flex
// behavior as close as possible

@mixin ekzo-flex-helpers--ie ($prefix: '', $postfix: '') {

  // -----
  // Main axis aligment

  .#{$prefix}flex--nowrap#{$postfix}    {
    display: table;

    > * { display: table-cell; }

  }

  .#{$prefix}flex-x--start#{$postfix} { text-align: left !important; }

  .#{$prefix}flex-x--center#{$postfix} {
    text-align: center !important;

    > * { text-align: left; }

  }

  .#{$prefix}flex-x--end#{$postfix} {
    text-align: right !important;

    > * { text-align: left; }

  }

  .#{$prefix}flex-x--between#{$postfix},
  .#{$prefix}flex-x--around#{$postfix} {
    text-align: justify !important;

    > * { text-align: left; }

  }

  // -----
  // Cross axis aligment

  .#{$prefix}flex-y--top#{$postfix}      { > * { vertical-align: top      !important; } }
  .#{$prefix}flex-y--center#{$postfix}   { > * { vertical-align: middle   !important; } }
  .#{$prefix}flex-y--end#{$postfix}      { > * { vertical-align: bottom   !important; } }
  .#{$prefix}flex-y--baseline#{$postfix} { > * { vertical-align: baseline !important; } }

  .#{$prefix}flex__item--start#{$postfix}    { vertical-align: top      !important; }
  .#{$prefix}flex__item--center#{$postfix}   { vertical-align: middle   !important; }
  .#{$prefix}flex__item--end#{$postfix}      { vertical-align: bottom   !important; }
  .#{$prefix}flex__item--baseline#{$postfix} { vertical-align: baseline !important; }

}

@mixin exports (
  $o-ns,
  $h-ns,
  $flex-helpers-breakpoints
) {
  @include clearfix($ns: $o-ns);

  // -----------------------------------------------------------------------------
  // Grid legacy hacks
  // -----------------------------------------------------------------------------
  //
  // @legacy
  //
  // 1. Serving non-flex grids for IE<10
  // 2. Used display model `inline-block` yeilds unwanted whitespaces
  //    which we have to removed with quite cruel method

  .#{$o-ns}grid { letter-spacing: -.31em; }

    .#{$o-ns}grid__item {
      vertical-align: top;
      display: inline-block; // 1
      letter-spacing: normal; // 2
    }

  // -----------------------------------------------------------------------------
  // Call
  // -----------------------------------------------------------------------------

  @include ekzo-for-each-breakpoint($matches: $flex-helpers-breakpoints, $include-self: true) {
    @include ekzo-flex-helpers--ie(
      $prefix: $h-ns,
      $postfix: ekzo-temp()
    );
  }

  // =============================================================================
  // ^MEDIA
  // =============================================================================
  // Fallback to float-based media object, since IE8-9 doesn't support flexbox

  .#{$o-ns}media { @extend %#{$o-ns}clearfix; }

    .#{$o-ns}media__aside {
      float: left;
      display: block;
    }

    .#{$o-ns}media__content {
      display: block;
      overflow: hidden;
    }

  // -----------------------------------------------------------------------------
  // Reversed version
  // -----------------------------------------------------------------------------

  .#{$o-ns}media--rev {

    .#{$o-ns}media__aside { float: right; }

  }

  // =============================================================================
  // ^NAV
  // =============================================================================

  // ----
  // Extends `.nav` and throws the list into vertical mode, e.g.:

  .#{$o-ns}nav--stacked {

    > a {
      float: left;
      clear: both;
    }

    > li { display: list-item; }

  }

  // -----------------------------------------------------------------------------
  // Packed nav
  // -----------------------------------------------------------------------------

  .#{$o-ns}nav--pack {
    display: table;
    width: 100%; // Fill all available space.

    > li,
    > a,
    > .#{$o-ns}nav__item { display: table-cell; }

  }

  .#{$o-ns}nav--fixed-pack {
    display: table;
    table-layout: fixed;

    width: 100%; // Fill all available space.

    > li,
    > a,
    > .#{$o-ns}nav__item { display: table-cell; }

  }

}